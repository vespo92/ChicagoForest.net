{
  "$schema": "./policy-schema.json",
  "name": "Chicago Forest Network Security Policy",
  "version": "1.0.0",
  "description": "Default security policy for the Chicago Forest Network ecosystem",
  "lastUpdated": "2025-11-23",
  "severity": {
    "threshold": "high",
    "failOn": ["critical", "high"],
    "warnOn": ["medium"],
    "ignoreBelow": "low"
  },
  "secrets": {
    "enabled": true,
    "patterns": [
      {
        "name": "API Key",
        "pattern": "api[_-]?key\\s*[:=]\\s*['\"][^'\"]+['\"]",
        "severity": "critical"
      },
      {
        "name": "AWS Access Key",
        "pattern": "AKIA[0-9A-Z]{16}",
        "severity": "critical"
      },
      {
        "name": "Private Key",
        "pattern": "-----BEGIN (RSA |EC |DSA )?PRIVATE KEY-----",
        "severity": "critical"
      },
      {
        "name": "Password",
        "pattern": "password\\s*[:=]\\s*['\"][^'\"]+['\"]",
        "severity": "high"
      },
      {
        "name": "JWT Token",
        "pattern": "eyJ[A-Za-z0-9-_]+\\.eyJ[A-Za-z0-9-_]+\\.[A-Za-z0-9-_.+/]*",
        "severity": "high"
      }
    ],
    "allowList": [
      "example",
      "placeholder",
      "test",
      "dummy",
      "YOUR_API_KEY_HERE"
    ]
  },
  "cryptography": {
    "enabled": true,
    "algorithms": {
      "forbidden": ["md5", "sha1", "des", "rc4", "blowfish"],
      "deprecated": ["3des", "sha224"],
      "recommended": ["aes-256-gcm", "chacha20-poly1305", "sha256", "sha384", "sha512"]
    },
    "keySize": {
      "minimum": 128,
      "recommended": 256
    },
    "tls": {
      "minimumVersion": "TLSv1.2",
      "recommendedVersion": "TLSv1.3",
      "forbiddenCiphers": ["RC4", "DES", "3DES", "MD5", "NULL", "EXPORT", "anon"]
    }
  },
  "code": {
    "enabled": true,
    "rules": [
      {
        "id": "no-eval",
        "name": "No eval()",
        "pattern": "eval\\s*\\(",
        "severity": "high",
        "message": "eval() can execute arbitrary code and should be avoided"
      },
      {
        "id": "no-innerhtml",
        "name": "No innerHTML",
        "pattern": "innerHTML\\s*=",
        "severity": "medium",
        "message": "innerHTML can lead to XSS vulnerabilities"
      },
      {
        "id": "no-document-write",
        "name": "No document.write",
        "pattern": "document\\.write\\s*\\(",
        "severity": "medium",
        "message": "document.write can lead to XSS vulnerabilities"
      },
      {
        "id": "no-exec-command",
        "name": "No child_process.exec",
        "pattern": "child_process\\.exec\\s*\\(",
        "severity": "high",
        "message": "exec() is vulnerable to command injection; use execFile() instead"
      }
    ]
  },
  "dependencies": {
    "enabled": true,
    "audit": true,
    "knownVulnerable": {
      "lodash": { "maxSafe": "4.17.21", "severity": "high" },
      "minimist": { "maxSafe": "1.2.6", "severity": "critical" },
      "node-fetch": { "maxSafe": "2.6.7", "severity": "high" },
      "axios": { "maxSafe": "0.21.4", "severity": "high" }
    }
  },
  "owasp": {
    "enabled": true,
    "passingScore": 70,
    "requiredCategories": [
      "A03:2021-Injection",
      "A07:2021-Auth-Failures"
    ]
  },
  "keyRotation": {
    "enabled": true,
    "maxAgeDays": 90,
    "warningDays": 14
  },
  "exclusions": {
    "paths": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.git/**",
      "**/*.test.ts",
      "**/*.spec.ts",
      "**/__tests__/**",
      "**/__mocks__/**"
    ],
    "files": [
      "*.min.js",
      "*.bundle.js",
      "*.map"
    ]
  },
  "reporting": {
    "format": "markdown",
    "outputDir": "./reports",
    "includeRemediation": true,
    "includeReferences": true
  }
}
